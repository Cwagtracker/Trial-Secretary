<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C-WAGS Trial Management System</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/print.css" media="print">
</head>
<body>
    <!-- Authentication Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-content">
            <div class="auth-header">
                <img src="images/cwags-logo.png" alt="C-WAGS" class="auth-logo">
                <h2>C-WAGS Trial Management System</h2>
            </div>
            
            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <h3>Login</h3>
                <form id="login-form-element">
                    <div class="form-group">
                        <label for="login-email">Email:</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password:</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="remember-me"> Remember me
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary">Login</button>
                    <div class="auth-links">
                        <a href="#" onclick="showRegisterForm()">Need an account? Register</a>
                        <a href="#" onclick="showForgotPassword()">Forgot password?</a>
                    </div>
                </form>
            </div>

            <!-- Registration Form -->
            <div id="register-form" class="auth-form" style="display: none;">
                <h3>Register New User</h3>
                <form id="register-form-element">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reg-first-name">First Name:</label>
                            <input type="text" id="reg-first-name" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-last-name">Last Name:</label>
                            <input type="text" id="reg-last-name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-organization">Organization/Club:</label>
                        <input type="text" id="reg-organization" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-phone">Phone:</label>
                        <input type="tel" id="reg-phone" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="reg-password">Password:</label>
                            <input type="password" id="reg-password" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-confirm-password">Confirm Password:</label>
                            <input type="password" id="reg-confirm-password" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reg-role">Account Type:</label>
                        <select id="reg-role" required>
                            <option value="">Select role...</option>
                            <option value="host">Trial Host</option>
                            <option value="judge">Judge</option>
                            <option value="secretary">Trial Secretary</option>
                            <option value="advocate">C-WAGS Advocate</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Register</button>
                    <div class="auth-links">
                        <a href="#" onclick="showLoginForm()">Already have an account? Login</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <img src="images/cwags-logo.png" alt="C-WAGS" class="header-logo">
                    <h1>Trial Management System</h1>
                </div>
                <div class="user-section">
                    <div class="user-info">
                        <span id="user-name">Loading...</span>
                        <span id="user-role" class="user-role"></span>
                    </div>
                    <button id="logout-btn" class="btn btn-secondary">Logout</button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="main-nav">
            <div class="nav-content">
                <button class="nav-btn active" data-module="dashboard">
                    üìä Dashboard
                </button>
                <button class="nav-btn" data-module="trial-setup">
                    üéØ Trial Setup
                </button>
                <button class="nav-btn" data-module="entries">
                    üìù Entry Management
                </button>
                <button class="nav-btn" data-module="paperwork">
                    üìÑ Paperwork Generation
                </button>
                <button class="nav-btn" data-module="scoring">
                    üèÜ Scoring & Results
                </button>
                <button class="nav-btn admin-only" data-module="admin" style="display: none;">
                    ‚öôÔ∏è Admin Panel
                </button>
            </div>
        </nav>

        <!-- Content Area -->
        <main class="main-content">
            <div id="module-container">
                <!-- Modules will be loaded here dynamically -->
            </div>
        </main>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-content">
                <span id="status-message">Ready</span>
                <span id="last-saved"></span>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>

    <!-- Scripts -->
   <script src="js/core/auth.js"></script>
<script src="js/core/data-manager.js"></script>
<script src="js/core/app.js"></script>
    
<!-- Module Scripts -->
<script src="js/modules/dashboard.js"></script>
<script src="js/modules/trial-setup.js"></script>
<script src="js/modules/entry-management.js"></script>
<script src="js/modules/paperwork-generator.js"></script>
<script src="js/modules/scoring-system.js"></script>
<script src="js/modules/admin-panel.js"></script>

<!-- Form Generators -->
<script src="js/forms/trial-application.js"></script>
<script src="js/forms/judge-forms.js"></script>
<script src="js/forms/premium-form.js"></script>
<script src="js/forms/score-sheets.js"></script>
<script src="js/forms/running-orders.js"></script>
<script src="js/forms/class-results.js"></script>

<script>
    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Initializing C-WAGS Trial Management System...');
        
        // Check if user is already logged in
        if (Auth.isLoggedIn()) {
            showMainApp();
        } else {
            showAuthModal();
        }
        
        // Initialize the application
        App.init();
    });

    function showAuthModal() {
        document.getElementById('auth-modal').style.display = 'flex';
        document.getElementById('main-app').style.display = 'none';
    }

    function showMainApp() {
        document.getElementById('auth-modal').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        App.loadUserInterface();
    }

    function showLoginForm() {
        document.getElementById('login-form').style.display = 'block';
        document.getElementById('register-form').style.display = 'none';
    }

    function showRegisterForm() {
        document.getElementById('login-form').style.display = 'none';
        document.getElementById('register-form').style.display = 'block';
    }

    function showForgotPassword() {
        alert('Password reset functionality would be implemented here. Please contact your administrator.');
    }
</script>
</body>
</html>

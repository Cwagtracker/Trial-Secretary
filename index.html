<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C-WAGS Trial Management System</title>
    
    <!-- Basic CSS - inline for debugging -->
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C-WAGS Trial Management System</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/auth.css">
</head>
<body>
    <!-- Authentication Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-content">
            <div class="auth-header">
                <h2>C-WAGS Trial Management System</h2>
                <p>Please login to continue</p>
            </div>
            
            <div id="message-area"></div>
            
            <form id="login-form-element">
                <div class="form-group">
                    <label for="login-email">Email:</label>
                    <input type="email" id="login-email" required value="admin@cwags.org">
                </div>
                <div class="form-group">
                    <label for="login-password">Password:</label>
                    <input type="password" id="login-password" required value="admin123">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="remember-me"> Remember me
                    </label>
                </div>
                <button type="submit" class="btn">Login</button>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="main-app" class="main-app">
        <header class="app-header">
            <div>
                <h1>C-WAGS Trial Management System</h1>
            </div>
            <div>
                <span id="user-name">System Administrator</span>
                <button id="logout-btn" class="btn" style="width: auto; margin-left: 15px;">Logout</button>
            </div>
        </header>

        <nav class="main-nav">
            <button class="nav-btn active" data-module="dashboard">üìä Dashboard</button>
            <button class="nav-btn" data-module="trial-setup">üéØ Trial Setup</button>
            <button class="nav-btn" data-module="entries">üìù Entry Management</button>
            <button class="nav-btn" data-module="paperwork">üìÑ Paperwork Generation</button>
            <button class="nav-btn" data-module="scoring">üèÜ Scoring & Results</button>
            <button class="nav-btn" data-module="admin">‚öôÔ∏è Admin Panel</button>
        </nav>

        <main class="main-content">
            <div id="module-container">
                <div class="dashboard-module">
                    <h2>Welcome to C-WAGS Trial Management System</h2>
                    <p>System is running successfully! üéâ</p>
                    <div style="margin-top: 20px;">
                        <h3>System Status:</h3>
                        <ul>
                            <li>‚úÖ Authentication: Working</li>
                            <li>‚úÖ Data Storage: Available</li>
                            <li>‚úÖ User Interface: Loaded</li>
                            <li>‚úÖ Core Functions: Ready</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Simple Authentication System
        class SimpleAuth {
            static users = [
                {
                    id: 'admin-001',
                    email: 'admin@cwags.org',
                    password: 'admin123',
                    firstName: 'System',
                    lastName: 'Administrator',
                    role: 'admin'
                }
            ];

            static currentUser = null;

            static login(email, password) {
                const user = this.users.find(u => 
                    u.email.toLowerCase() === email.toLowerCase() && 
                    u.password === password
                );
                
                if (user) {
                    this.currentUser = user;
                    localStorage.setItem('cwags_current_user', JSON.stringify(user));
                    return true;
                }
                return false;
            }

            static logout() {
                this.currentUser = null;
                localStorage.removeItem('cwags_current_user');
            }

            static isLoggedIn() {
                if (this.currentUser) return true;
                
                const stored = localStorage.getItem('cwags_current_user');
                if (stored) {
                    this.currentUser = JSON.parse(stored);
                    return true;
                }
                return false;
            }

            static getCurrentUser() {
                return this.currentUser;
            }
        }

        // Simple App Controller
        class SimpleApp {
            static init() {
                this.setupEventListeners();
                this.checkLoginStatus();
            }

            static setupEventListeners() {
                // Login form
                document.getElementById('login-form-element').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                // Logout button
                document.getElementById('logout-btn').addEventListener('click', () => {
                    this.handleLogout();
                });

                // Navigation buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.switchModule(e.target.dataset.module);
                        // Update active state
                        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                    });
                });
            }

            static handleLogin() {
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;

                if (SimpleAuth.login(email, password)) {
                    this.showMessage('Login successful!', 'success');
                    setTimeout(() => {
                        this.showMainApp();
                    }, 1000);
                } else {
                    this.showMessage('Invalid email or password', 'error');
                }
            }

            static handleLogout() {
                SimpleAuth.logout();
                this.showAuthModal();
            }

            static checkLoginStatus() {
                if (SimpleAuth.isLoggedIn()) {
                    this.showMainApp();
                } else {
                    this.showAuthModal();
                }
            }

            static showAuthModal() {
                document.getElementById('auth-modal').style.display = 'flex';
                document.getElementById('main-app').style.display = 'none';
                this.clearMessages();
            }

            static showMainApp() {
                document.getElementById('auth-modal').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
                
                const user = SimpleAuth.getCurrentUser();
                if (user) {
                    document.getElementById('user-name').textContent = `${user.firstName} ${user.lastName}`;
                }
            }

            static switchModule(moduleName) {
                const container = document.getElementById('module-container');
                
                switch(moduleName) {
                    case 'dashboard':
                        container.innerHTML = `
                            <div class="dashboard-module">
                                <h2>üìä Dashboard</h2>
                                <p>Welcome to the C-WAGS Trial Management System dashboard.</p>
                                <div style="margin-top: 20px;">
                                    <h3>Quick Stats:</h3>
                                    <ul>
                                        <li>Total Trials: 0</li>
                                        <li>Total Entries: 0</li>
                                        <li>Active Users: 1</li>
                                        <li>System Status: ‚úÖ Operational</li>
                                    </ul>
                                </div>
                            </div>
                        `;
                        break;
                    case 'trial-setup':
                        container.innerHTML = `
                            <div class="module">
                                <h2>üéØ Trial Setup</h2>
                                <p>Create and manage C-WAGS trials.</p>
                                <p><em>This module is ready for development.</em></p>
                            </div>
                        `;
                        break;
                    case 'entries':
                        container.innerHTML = `
                            <div class="module">
                                <h2>üìù Entry Management</h2>
                                <p>Manage trial entries and registrations.</p>
                                <p><em>This module is ready for development.</em></p>
                            </div>
                        `;
                        break;
                    case 'paperwork':
                        container.innerHTML = `
                            <div class="module">
                                <h2>üìÑ Paperwork Generation</h2>
                                <p>Generate trial forms and documents.</p>
                                <p><em>This module is ready for development.</em></p>
                            </div>
                        `;
                        break;
                    case 'scoring':
                        container.innerHTML = `
                            <div class="module">
                                <h2>üèÜ Scoring & Results</h2>
                                <p>Manage scoring and generate results.</p>
                                <p><em>This module is ready for development.</em></p>
                            </div>
                        `;
                        break;
                    case 'admin':
                        container.innerHTML = `
                            <div class="module">
                                <h2>‚öôÔ∏è Admin Panel</h2>
                                <p>System administration and user management.</p>
                                <p><em>This module is ready for development.</em></p>
                            </div>
                        `;
                        break;
                    default:
                        container.innerHTML = `
                            <div class="module">
                                <h2>Module Not Found</h2>
                                <p>The requested module "${moduleName}" could not be loaded.</p>
                            </div>
                        `;
                }
            }

            static showMessage(message, type) {
                const messageArea = document.getElementById('message-area');
                messageArea.innerHTML = `<div class="${type}-message">${message}</div>`;
            }

            static clearMessages() {
                document.getElementById('message-area').innerHTML = '';
            }
        }

        // Initialize the application when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing C-WAGS Trial Management System...');
            SimpleApp.init();
            console.log('‚úÖ System initialized successfully!');
        });
    </script>
</body>
</html>
